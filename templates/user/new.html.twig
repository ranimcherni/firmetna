{% extends 'base.html.twig' %}

{% block title %}S'inscrire - FIRMETNA{% endblock %}

{% block body %}
<div class="container-fluid p-0">
    <div class="row g-0 min-vh-100">
        <!-- Côté Gauche : Image et Message (Même que Login) -->
        <div class="col-lg-5 d-none d-lg-flex flex-column justify-content-center align-items-center text-white position-relative" style="background: linear-gradient(rgba(26, 77, 46, 0.8), rgba(26, 77, 46, 0.8)), url('{{ asset('images/hero-bg.png') }}'); background-size: cover; background-position: center;">
            <div class="p-5 text-start" style="max-width: 500px;">
                <h1 class="display-4 fw-bold mb-4">Cultivez votre avenir avec nous</h1>
                <p class="lead mb-5">Rejoignez la première plateforme agricole qui connecte producteurs, clients et volontaires.</p>
                
                <ul class="list-unstyled">
                    <li class="mb-3"><i class="fas fa-check-circle me-3"></i> Gestion complète de votre exploitation</li>
                    <li class="mb-3"><i class="fas fa-check-circle me-3"></i> Accès au marketplace local</li>
                    <li class="mb-3"><i class="fas fa-check-circle me-3"></i> Communauté de 500+ agriculteurs</li>
                    <li class="mb-3"><i class="fas fa-check-circle me-3"></i> Support et conseils experts</li>
                </ul>
            </div>
        </div>

        <!-- Côté Droit : Formulaire -->
        <div class="col-lg-7 d-flex flex-column justify-content-center bg-white p-5 overflow-auto">
            <div class="w-100 mx-auto" style="max-width: 600px;">
                <div class="mb-4">
                    <img src="{{ asset('images/logo_hand.png') }}" alt="Logo FIRMETNA" height="85" class="mb-3">
                    <br>
                    <small class="text-warning fw-bold"><i class="fas fa-sun me-1"></i> Bienvenue sur FIRMETNA</small>
                    <h2 class="fw-bold mt-2">Créer un compte</h2>
                    <p class="text-muted">Rejoignez notre communauté agricole en quelques minutes</p>
                </div>

                {{ form_start(form) }}
                    <!-- Photo Section -->
                    <div class="d-flex align-items-center mb-4">
                        <div class="position-relative">
                            <div class="bg-success rounded-3 d-flex align-items-center justify-content-center text-white" style="width: 80px; height: 80px;">
                                <i class="fas fa-user fa-3x"></i>
                            </div>
                            <span class="position-absolute bottom-0 end-0 bg-dark text-white rounded-circle p-1" style="font-size: 10px; cursor: pointer;">
                                <i class="fas fa-camera"></i>
                            </span>
                        </div>
                        <div class="ms-3">
                            <div class="fw-bold">Ajouter une photo</div>
                            <small class="text-muted">JPG, PNG ou GIF - Max 5MB</small>
                            {{ form_widget(form.profile.imageUrl, {'attr': {'class': 'd-none'}}) }}
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <label class="form-label fw-bold small">Prénom</label>
                            <div class="input-group">
                                <span class="input-group-text bg-light border-end-0"><i class="fas fa-user text-muted"></i></span>
                                {{ form_widget(form.profile.prenom, {'attr': {'class': 'form-control bg-light border-start-0', 'placeholder': 'Jean'}}) }}
                            </div>
                        </div>
                        <div class="col-md-6 mb-3">
                            <label class="form-label fw-bold small">Nom</label>
                            {{ form_widget(form.profile.nom, {'attr': {'class': 'form-control bg-light', 'placeholder': 'Dupont'}}) }}
                        </div>
                    </div>

                    <div class="mb-3">
                        <label class="form-label fw-bold small">Email</label>
                        <div class="input-group">
                            <span class="input-group-text bg-light border-end-0"><i class="fas fa-envelope text-muted"></i></span>
                            {{ form_widget(form.email, {'attr': {'class': 'form-control bg-light border-start-0', 'placeholder': 'votre@email.com'}}) }}
                        </div>
                    </div>

                    <div class="mb-3">
                        <label class="form-label fw-bold small">Téléphone</label>
                        <div class="input-group">
                            <span class="input-group-text bg-light border-end-0"><i class="fas fa-phone text-muted"></i></span>
                            {{ form_widget(form.profile.telephone, {'attr': {'class': 'form-control bg-light border-start-0', 'placeholder': '+33 6 12 34 56 78'}}) }}
                        </div>
                    </div>

                    <div class="mb-4">
                        <label class="form-label fw-bold small">Je suis un...</label>
                        <div class="row g-2">
                            <div class="col-4">
                                <input type="radio" class="btn-check" name="role_select" id="role_agri" value="AGRICULTEUR" autocomplete="off">
                                <label class="btn btn-outline-light text-dark w-100 py-3 border" for="role_agri">
                                    <i class="fas fa-seedling d-block mb-1"></i>
                                    <small>Agriculteur</small>
                                </label>
                            </div>
                            <div class="col-4">
                                <input type="radio" class="btn-check" name="role_select" id="role_client" value="CLIENT" autocomplete="off">
                                <label class="btn btn-outline-light text-dark w-100 py-3 border" for="role_client">
                                    <i class="fas fa-user d-block mb-1"></i>
                                    <small>Client</small>
                                </label>
                            </div>
                            <div class="col-4">
                                <input type="radio" class="btn-check" name="role_select" id="role_vol" value="VOLONTAIRE" autocomplete="off">
                                <label class="btn btn-outline-light text-dark w-100 py-3 border" for="role_vol">
                                    <i class="fas fa-hand-holding-heart d-block mb-1"></i>
                                    <small>Volontaire</small>
                                </label>
                            </div>
                        </div>
                        {{ form_widget(form.profile.roleType, {'attr': {'class': 'd-none', 'id': 'profile_roleType'}}) }}
                    </div>

                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <label class="form-label fw-bold small">Mot de passe</label>
                            <div class="input-group">
                                <span class="input-group-text bg-light border-end-0"><i class="fas fa-lock text-muted"></i></span>
                                {{ form_widget(form.password, {'attr': {'class': 'form-control bg-light border-start-0', 'placeholder': '••••••••'}}) }}
                            </div>
                        </div>
                        <div class="col-md-6 mb-3">
                            <label class="form-label fw-bold small">Confirmer</label>
                            <div class="input-group">
                                <span class="input-group-text bg-light border-end-0"><i class="fas fa-lock text-muted"></i></span>
                                <input type="password" class="form-control bg-light border-start-0" placeholder="••••••••">
                            </div>
                        </div>
                    </div>

                    <button type="submit" class="btn btn-success w-100 py-3 fw-bold shadow-sm mt-3">Créer mon compte</button>
                    
                    <p class="text-center small text-muted mt-3">
                        En créant un compte, vous acceptez nos <a href="#" class="text-success fw-bold text-decoration-none">Conditions d'utilisation</a> et notre <a href="#" class="text-success fw-bold text-decoration-none">Politique de confidentialité</a>
                    </p>

                    <p class="text-center mt-4">Déjà un compte ? <a href="{{ path('app_login') }}" class="text-success fw-bold text-decoration-none">Se connecter</a></p>
                
                <div class="d-none">
                    {{ form_rest(form) }}
                </div>
                {{ form_end(form) }}
            </div>
        </div>
    </div>
</div>

<script>
    document.querySelectorAll('input[name="role_select"]').forEach(radio => {
        radio.addEventListener('change', function() {
            const hiddenInput = document.querySelector('input[name="user[profile][roleType]"]');
            if (hiddenInput) {
                hiddenInput.value = this.value;
            }
        });
    });
</script>

<style>
    .btn-check:checked + .btn-outline-light {
        background-color: #f8f9fa !important;
        border-color: #1a4d2e !important;
        color: #1a4d2e !important;
        font-weight: bold;
    }
</style>
{% endblock %}
